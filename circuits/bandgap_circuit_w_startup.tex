
\begin{circuitikz}[scale=0.5, transform shape, american resistors]
    \draw
    (0,5) node[pmos, xscale=-1](pmos1){}
    (pmos1.S) -- (0,6)
    (3,5) node[pmos](pmos2){}
    (pmos2.S) -- (3,6)
    (pmos1.G) -- (pmos2.G)
    (pmos1.D) -- (0,4)
    (pmos2.D) -- (3,4)
   
    (0,4) to [R] ++(0,-2)
    to [R] ++(0,-2)
    to [Do] ++(0,-2)

    (3,4) to [R] ++(0,-2)
    to [short] ++(0,-2)
    to [Do] ++(0,-2)
    to[short] ++(-5,0)
    
    (-2,-2) to[R] ++(0,3)
    to[R] ++(0,3)
    -| (pmos1.D)

    (6,-2) to[R] ++(0,3)
    to[R] ++(0,3)
    -| (pmos2.D)

    (6,4) to[short,-o] ++(0.5, 0)
    node[anchor=west]{$V_{bg}$}
    (4,4) to[C] ++(0,-6)
    
    (6,1) to[short,-o] ++(0.5, 0)
    node[anchor=west]{$V_{ref}$}
    
    (0,2) to[short,-o] ++(0.3,0)
    node[anchor=west]{-}
    (3,2) to[short,-o] ++(-0.3,0)
    node[anchor=east]{+}

    (0,-2) to[short] ++(6,0)   
    (0,6) to[short] ++(3,0)

    (10,0) node[op amp](opamp1){}
    (12,0) node[nmos](nmos1){}
    (opamp1.out) |- (nmos1.G)
    (nmos1.S)  |- (0,-2)
    (12,5) node[pmos](pmos3){}
    (pmos3.D) -- (nmos1.D)
    (pmos3.D) -| (pmos3.G)
    (pmos3.S) |- (0,6)
    
    (pmos3.G) node[anchor=east] {$V_b$}
    (pmos1.G) to[short] ++(0.5,0)
    node[anchor=north]{$V_b$}
    
    (13,0) node[nmos, xscale=-1](nmos2){}
    (nmos2.S) |- (12,-2)
    (nmos2.D) |- (12,2.5)

    (16,0) node[nmos](nmos3){}
    (16,5) node[pmos, xscale=-1](pmos5){}
    (nmos3.S) |- (12,-2)
    (nmos3.D) -- (pmos5.D)
    (nmos3.G) to[short,-o] ++(-0.2,0)
    node[anchor=east]{$V_{bg}$}
    (nmos2.G) |- (nmos3.D)
    (pmos5.S) |- (0,6)

    (19,5) node[pmos](pmos6){}
    (pmos6.S) |- (0,6)
    (pmos6.G) -- (pmos5.G) 
    (pmos6.D) to[C] (19,-2)

    (18,3) node[pmos](pmos7){}
    (pmos7.G) |- (18,6)
    (pmos7.S) |- (pmos6.G)
    (pmos7.S) -| (pmos6.D)
    (pmos7.D) -- (18,-2)
    (19,-2) -- (0,-2)
    ;
\end{circuitikz}
    
